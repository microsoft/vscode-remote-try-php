!function(i){EmailTemplatesAdmin={init(){i(document).on("click","#wcf_preview_email",EmailTemplatesAdmin.send_test_email),i(document).on("click",".wcf-ca-switch.wcf-toggle-template-status",EmailTemplatesAdmin.toggle_activate_template),i(document).on("click","#wcf_ca_delete_coupons",EmailTemplatesAdmin.delete_coupons),i(document).on("click","#wcf_ca_export_orders",EmailTemplatesAdmin.export_orders),i(document).on("click",".wcar-switch-grid",EmailTemplatesAdmin.toggle_activate_template_on_grid);const e="#wcf_email_discount_type, #wcf_email_discount_amount, #wcf_email_coupon_expiry_date, #wcf_free_shipping_coupon, #wcf_auto_coupon_apply, #wcf_individual_use_only";i(e).closest("tr").toggle(i("#wcf_override_global_coupon").is(":checked")),i(document).on("click","#wcf_override_global_coupon",function(){i(e).closest("tr").fadeToggle(i("#wcf_override_global_coupon").is(":checked"))})},send_test_email(){let e="";e=jQuery("#wp-wcf_email_body-wrap").hasClass("tmce-active")?tinyMCE.get("wcf_email_body").getContent():jQuery("#wcf_email_body").val();var a=i("#wcf_email_subject").val(),t=i("#wcf_send_test_email").val(),c=document.getElementsByName("id")[0].value,s=i("#_wpnonce").val();i(this).next("div.error").remove(),i.trim(e)?i.trim(a)?i.trim(t)?(s={email_subject:a,email_body:e,email_send_to:t,email_template_id:c,action:"wcf_ca_preview_email_send",security:s},i("#wcf_preview_email").css("cursor","wait").attr("disabled",!0),i.post(ajaxurl,s,function(e){i("#mail_response_msg").empty().fadeIn(),e.success?i("#mail_response_msg").css("color","green").html("<strong> Email has been sent successfully! </strong>").delay(3e3).fadeOut():i("#mail_response_msg").css("color","red").html("<strong> Email sending failed! Please check your SMTP settings!  </a></strong>").delay(3e3).fadeOut(),i("#wcf_preview_email").css("cursor","").attr("disabled",!1)})):i(this).after('<div class="error-message wcf-ca-error-msg"> You must add your email id! </div>'):i(this).after('<div class="error-message wcf-ca-error-msg"> Email subject is required! </div>'):i(this).after('<div class="error-message wcf-ca-error-msg"> Email body is required! </div>'),i(".wcf-ca-error-msg").delay(2e3).fadeOut()},delete_coupons(){var e;confirm(wcf_ca_localized_vars._confirm_msg)&&(e={action:"wcf_ca_delete_garbage_coupons",security:wcf_ca_localized_vars._delete_coupon_nonce},i(".wcf-ca-spinner").show(),i(".wcf-ca-spinner").addClass("is-active"),i("#wcf_ca_delete_coupons").css("cursor","wait").attr("disabled",!0),i.post(ajaxurl,e,function(e){i(".wcf-ca-response-msg").empty().fadeIn(),e.success&&(i(".wcf-ca-spinner").hide(),i(".wcf-ca-response-msg").css("color","green").html(e.data).delay(5e3).fadeOut()),i("#wcf_ca_delete_coupons").css("cursor","").attr("disabled",!1)}))},export_orders(){confirm(wcf_ca_localized_vars._confirm_msg_export)&&(window.location.href=window.location.search+"&export_data=true&security="+wcf_ca_localized_vars._export_orders_nonce)},toggle_activate_template_on_grid(){const a=i(this),e=a.attr("wcf-ca-template-switch"),t="on"===e?"green":"red";i.post(ajaxurl,{action:"activate_email_templates",id:i(this).attr("id"),state:e,security:wcf_ca_details.email_toggle_button_nonce},function(e){i("#wcf_activate_email_template").val(0),i(".wcar_tmpl_response_msg").remove(),i("<span class='wcar_tmpl_response_msg'> "+e.data+" </span>").insertAfter(a).delay(2e3).fadeOut().css("color",t)})},toggle_activate_template(){const e=i(this),a=e.attr("wcf-ca-template-switch");var t="on"===a?"off":"on";i("#wcf_activate_email_template").val("on"==t?1:0),e.attr("wcf-ca-template-switch",t)}},i(function(){EmailTemplatesAdmin.init()})}(jQuery);